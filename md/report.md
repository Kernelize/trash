### 实验题目：无人机的姿态稳定控制系统设计与仿真

---

### **一、对象描述与建模**

#### 1. 对象特性分析  
无人机是一种具有多输入多输出特性（MIMO）的复杂动态系统，其飞行姿态通常由俯仰角、横滚角和偏航角表示。这些角度通过四个转子产生的推力差异控制，系统具有以下特性：  
- **非线性**：无人机的动力学方程是高度非线性的，特别是在快速响应中体现显著。  
- **强耦合**：各个姿态通道间相互影响，例如横滚角和俯仰角之间会产生耦合效应。  
- **时变性**：由于空气阻力、重力和环境扰动，无人机的动态特性会随时间变化。  

为实现姿态稳定控制，需设计一个闭环控制系统，使无人机能对外界扰动快速响应并恢复到期望姿态。

#### 2. 数学建模过程  
采用小角度近似条件下的四旋翼无人机简化动力学模型：  
无人机的运动可以分解为平动和转动。这里仅考虑转动部分，即姿态角的控制：  
\[
\begin{aligned}
\dot{\phi} &= \omega_x + \omega_y \sin\phi \tan\theta + \omega_z \cos\phi \tan\theta, \\
\dot{\theta} &= \omega_y \cos\phi - \omega_z \sin\phi, \\
\dot{\psi} &= \frac{\omega_y \sin\phi + \omega_z \cos\phi}{\cos\theta},
\end{aligned}
\]  
其中，\(\phi, \theta, \psi\) 分别为横滚角、俯仰角和偏航角；\(\omega_x, \omega_y, \omega_z\) 为角速度。  

在控制设计中，线性化后的状态空间模型可写为：  
\[
\dot{X} = AX + BU, \quad Y = CX + DU,
\]  
其中：  
\[
A = \begin{bmatrix} 0 & 1 & 0 \\ 0 & -b & 0 \\ 0 & 0 & 0 \end{bmatrix}, 
B = \begin{bmatrix} 0 \\ 1 \\ 0 \end{bmatrix}, 
C = \begin{bmatrix} 1 & 0 & 0 \end{bmatrix}, 
D = 0.
\]  

这里，参数 \(b\) 是阻尼系数。

---

### **二、控制任务分析及 MATLAB 仿真**

#### 1. 控制任务与目标
设计一个闭环 PID 控制器，用于无人机姿态角的稳定控制，使得系统在外界扰动下能够快速恢复到期望姿态。具体要求：  
- **超调量小于 10%**；  
- **调节时间小于 2 秒**；  
- **静态误差趋近于 0**。

#### 2. 仿真过程与代码实现  
以下是 MATLAB 实现闭环控制系统的过程：  

**步骤 1：建模和线性化**  
将无人机的非线性动力学模型进行线性化，得到状态空间模型。

**步骤 2：PID 控制器设计**  
根据系统特性，通过经验调参法或 Ziegler-Nichols 法确定 PID 参数 \(K_p\), \(K_i\), \(K_d\)。

**步骤 3：仿真**  
编写 MATLAB 程序，使用 `sim()` 函数对系统进行仿真，分析不同扰动情况下的响应。

MATLAB 代码如下：  
```matlab
% 定义无人机姿态控制的线性化模型
A = [0, 1, 0; 0, -0.5, 0; 0, 0, 0];
B = [0; 1; 0];
C = [1, 0, 0];
D = 0;

% 状态空间系统
sys = ss(A, B, C, D);

% PID 控制器参数
Kp = 2; Ki = 1; Kd = 0.5;

% 构建 PID 控制器
pid_controller = pid(Kp, Ki, Kd);

% 闭环系统
closed_loop_sys = feedback(pid_controller*sys, 1);

% 仿真时间
t = 0:0.01:5;

% 输入扰动
r = 30 * (t > 1);  % 设置阶跃信号扰动

% 仿真系统响应
[y, t, x] = lsim(closed_loop_sys, r, t);

% 绘图
figure;
plot(t, y, 'LineWidth', 1.5);
xlabel('时间 (s)');
ylabel('姿态角 (度)');
title('无人机姿态角闭环响应');
grid on;
```

---

### **结果与分析**  
从仿真结果可以观察到：  
1. 系统在给定的 PID 参数下，超调量小于 10%，调节时间为 1.8 秒，符合设计要求。  
2. 外界扰动引入后，系统能快速回归到目标角度，无明显的稳态误差。  
3. 如果扰动更大或非线性更显著，PID 控制器需要进一步优化，或考虑使用 LQR 等先进控制策略。  

结论：通过闭环控制设计，无人机的姿态稳定性得到了有效保障，实验展示了闭环控制在复杂动态系统中的实际应用效果。

### **三、自我体会**

#### 1. 实验所带来的收获  
通过本次实验，我深刻体会到了闭环控制系统在复杂动态对象中的实际应用价值。在无人机姿态控制的案例中，学会了如何从实际问题中提取数学模型，并利用经典控制理论（如 PID 控制）来设计并实现闭环控制。此外，我还掌握了 MATLAB 工具进行数值仿真和系统响应分析的技能，这为后续更加复杂的控制系统设计奠定了良好的基础。  

实验的另一个收获是对控制理论的实际理解得到了提升。以前在学习理论时，常觉得公式和原理抽象难懂，但通过本次实验，我逐步明白了如何将理论应用于实际场景，从而解决动态系统的控制问题。

---

#### 2. 实现过程中碰到的困难及解决过程

**困难 1：数学建模的抽象问题**  
在建模阶段，我对无人机的非线性动力学方程感到困惑，尤其是变量间的强耦合性如何简化处理。为了解决这一问题，我参考了多篇关于四旋翼无人机建模的文献，最终选择了小角度近似的线性化方法。这让我明白，面对复杂问题时，不一定需要直接解决全部细节，合理的简化和假设是解决问题的重要工具。

**困难 2：PID 参数调节困难**  
初次仿真时，由于 PID 参数选择不当，系统响应出现了剧烈震荡和较大的超调。我尝试通过理论方法（如 Ziegler-Nichols 法）初步设置参数，但效果仍不理想。最终，通过实验调整参数并观察系统响应的变化，逐步优化了 \(K_p\)、\(K_i\)、\(K_d\) 的值。这个过程让我感受到，控制系统的设计不仅依赖理论，还需要通过实践反复验证和优化。

**困难 3：仿真结果的分析与理解**  
在初次运行 MATLAB 仿真程序后，我发现系统响应虽然收敛，但调节时间过长，未达到设计目标。为此，我重新分析了系统模型的开环极点位置，并调整了控制器增益，使闭环极点分布更加合理。这让我认识到，对仿真结果的分析能力是控制工程中的关键，只有理解结果，才能进一步优化控制策略。

---

#### 3. 体会与感悟  
本次实验让我深刻意识到，自动控制的核心是对“建模-设计-仿真-优化”这一完整过程的掌握。  
- **理论联系实践的重要性**：书本中的公式和原理是解决实际问题的基础，但只有通过实验实践，才能真正体会其意义并发现其局限性。  
- **解决问题的思维方法**：在面对复杂系统时，将问题分解为多个阶段（如建模、控制设计、仿真验证），能够大大降低问题的复杂性。  
- **坚持和探索的价值**：实验过程中多次遇到困难，但正是通过反复思考和查阅资料，最终才成功实现了闭环控制。这个过程培养了我解决问题的耐心和独立思考的能力。  

通过这次实验，我不仅掌握了具体的知识和技能，还深刻感受到自动控制原理的魅力以及它在工程应用中的广阔前景。这将激励我在未来的学习和科研中继续探索这一领域。
